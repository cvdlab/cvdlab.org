<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<polymer-element name="part-form" attributes="alumnus">
  <template>
    <!-- <link rel="stylesheet" href="../../styles/bootstrap.min.css"> -->
    <style>
      :host {
        display: block;
      }

      #submit {
        margin-top: 36px;
        margin-bottom: 36px;
      }

      h1 {
        margin-bottom: 18px;
      }

      .form-group input,
      .form-group select {
        border-radius: 2px;
        box-shadow: none;
        outline: none;
      }

      #picture {
        background-size: cover;
        position: relative;
        width: 200px;
        height: 200px;
        padding-bottom: 30px;
      }

      #file {
        display: none;
      }
    </style>

    <!-- <core-ajax id="get_data" method="GET" url="/api/v0/alumni/{{ id }}" handleAs="json" on-core-response="{{on_get_data}}"></core-ajax> -->
    <core-ajax id="send_data" method="POST" url="/api/v0/alumni/{{ alumnus._id }}" handleAs="json" on-core-response="{{on_send_data}}"></core-ajax>

    <div class="container">
      <h1 id="id-label"><span class="label label-default">{{ student_id }}</span></h1>
      <div>
        <div id="picture" style="background-image: url('{{ alumnus.picture }}')"></div>
      </div>
      <form role="form">
        <div class="form-group">
          <label for="first_name">First name</label>
          <input type="text" class="form-control input-lg" id="first_name" name="first_name" placeholder="Enter your first name" value="{{ alumnus.first_name }}">
        </div>
        <div class="form-group">
          <label for="last_name">Last name</label>
          <input type="text" class="form-control input-lg" id="last_name" name="last_name" placeholder="Enter your last name" value="{{ alumnus.last_name }}">
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" class="form-control input-lg" id="email" name="email" placeholder="Enter your email address" value="{{ alumnus.email }}">
        </div>
        <div class="form-group">
          <label for="website">Personal website address [optional]</label>
          <input type="url" class="form-control input-lg" id="website" name="website" placeholder="Enter your personal website address, if any" value="{{ alumnus.website }}">
        </div>
        <div class="form-group">
          <label for="github_username">GitHub username</label>
          <input type="text" class="form-control input-lg" id="github_username" name="github_username" placeholder="Enter your GitHub username" value="{{ alumnus.github_username }}">
        </div>
        <div class="form-group">
          <label for="year">Year</label>
          <select class="form-control input-lg" id="year" name="year" value="{{ alumnus.year }}">
            <option value="">Select the year in which you take the course</option>
            <option value="2012" selected?="{{ alumnus.year == 2011 }}">2011</option>
            <option value="2012" selected?="{{ alumnus.year == 2012 }}">2012</option>
            <option value="2013" selected?="{{ alumnus.year == 2013 }}">2013</option>
            <option value="2014" selected?="{{ alumnus.year == 2014 }}">2014</option>
          </select>
        </div>
      </form>
      <button id="submit" on-click="{{ submit }}" class="btn btn-lg {{submit_button_type}} btn-block">{{ submit_text }}</button>
    </div>
  </template>
  <script>
    Polymer('part-form', {

      submit_text: 'Submit',

      submit_button_type: 'btn-primary',

      on_response: function (event, detail, sender) {
        var response = detail.response;
        this.alumnus = response;
      },

      on_send_data: function () {
        page.show('/alumni');
      },

      submit: function (e) {
        e.preventDefault();
        var self = this;
        var send_data = this.$.send_data;

        var data = {
          student_id: this.alumnus.student_id,
          first_name: this.alumnus.first_name,
          last_name: this.alumnus.last_name,
          email: this.alumnus.email,
          website: this.alumnus.website,
          github_username: this.alumnus.github_username,
          year: +this.alumnus.year
        };

        send_data.params = JSON.stringify(data);
        send_data.go();
      },

    });
  </script>
</polymer-element>
